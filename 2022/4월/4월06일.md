## ğŸ˜€ 2022.04.06.ìˆ˜

<br/>

# âœ¨ history API

- ë¸Œë¼ìš°ì €ì—ì„œ í˜ì´ì§€ë¥¼ ë¡œë”©í•˜ë©´ ì„¸ì…˜ íˆìŠ¤í† ë¦¬ë¥¼ ê°–ê²Œëœë‹¤. 
  ì„¸ì…˜ íˆìŠ¤í† ë¦¬ëŠ” í˜ì´ì§€ë¥¼ ì´ë™í•  ë•Œë§ˆë‹¤ ìŒ“ì´ê²Œ ë˜ë©° ì´ë¥¼ í†µí•´ ë’¤ë¡œê°€ê¸°, ì•ìœ¼ë¡œê°€ê¸° ë“± ì´ë™ì´ ê°€ëŠ¥í•´ ì§„ë‹¤.
- ì¼ë°˜ urlí˜•ì‹ì„ ë”°ë¥´ê¸° ë•Œë¬¸ì— querystringë„ ììœ ë¡­ê²Œ ë¶™ì¼ ìˆ˜ ìˆê²Œ ëœë‹¤.
- pushState: ì„¸ì…˜ íˆìŠ¤í† ë¦¬ì— ìƒˆ url ìƒíƒœë¥¼ ìŒ“ëŠ”ë‹¤.
- replaceState: ì„¸ì…˜ íˆìŠ¤í† ë¦¬ì— ìƒˆ url ì„ ìŒ“ì§€ ì•Šê³  í˜„ì¬ urlì„ ëŒ€ì²´í•œë‹¤.
  ex) form ì‘ì„±ì™„ë£Œ í›„ ìš”ì²­ì„ ë³´ë‚´ê³  ë‹¤ì‹œ ë’¤ë¡œê°€ê¸°ë¥¼ í–ˆì„ë•Œ ë™ì‘ì„ ë°©ì§€í•˜ëŠ” ìš©ë„
- history apië¡œ urlì„ ë³€ê²½í•œ í›„ ìƒˆë¡œê³ ì¹¨ ì‹œ ë³€ê²½ëœ urlì˜ ì‹¤ì œ íŒŒì¼ì„ ì°¾ìœ¼ë ¤ í•˜ê¸° ë•Œë¬¸ì— 404ì—ëŸ¬ê°€ ë‚œë‹¤.
  -> ì´ë•Œ 404 ì• ëŸ¬ê°€ ë‚¬ì„ ê²½ìš° rootì˜ index.htmlë¡œ ìš”ì²­ì„ ëŒë ¤ì£¼ëŠ” ì²˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤.

```js
history.pushState(state, title, url)
history.replaceState(state, title, url)
// state: history.stateì—ì„œ êº¼ë‚´ ì“¸ ìˆ˜ ìˆëŠ” ê°’
// title: ì§§ê²Œ ìƒíƒœì—ëŒ€í•œ ì œëª©ì„ ì œê³µ(ëŒ€ë¶€ë¶„ì˜ ë¸Œë¼ìš°ì €ê°€ title ë³€ìˆ˜ë¥¼ ë¬´ì‹œí•´ì„œ ë¹ˆë¬¸ìì—´ë¡œ ì‘ì„±í•œë‹¤.)
// url: ì„¸ì…˜ íˆìŠ¤í† ë¦¬ì— ìƒˆë¡œ ë„£ì„ url, aíƒœê·¸ë¥¼ í´ë¦­í•˜ê±°ë‚˜ location.hrefë¡œ urlì„ ë³€ê²½í•œ ê²ƒ ê³¼ëŠ” ë‹¤ë¥´ê²Œ í™”ë©´ì´ ë¦¬ë¡œë“œ ë˜ê±°ë‚˜ í•˜ì§€ ì•ŠëŠ”ë‹¤.
```
![history](../../images/2022/04/06.jpg)

- length: ì§€ê¸ˆê¹Œì§€ ìŒ“ì—¬ìˆëŠ” íˆìŠ¤í† ë¦¬ ê°¯ìˆ˜
- scrollRestoration: ê¸°ë¡ íƒìƒ‰ ì‹œ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì˜ ë³µì›ì—¬ë¶€(auto, manual)
- state: ê¸°ë¡ ìŠ¤íƒ ìµœìƒë‹¨ì˜ ìŠ¤í…Œì´íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’
<https://developer.mozilla.org/ko/docs/Web/API/History>

```js
// routerë¡œ pathì— ë”°ë¼ ë³´ì—¬ì¤„ í˜ì´ì§€ ì§€ì •
function route() {
  const { pathname } = location;
  const $container = document.querySelector("#container");
  if (pathname === "/") {
    $container.innerHTML = "Home";
  } else if (pathname === "/product-list") {
    $container.innerHTML = "<h1>ìƒí’ˆëª©ë¡</h1>";
  } else if (pathname === "/article-list") {
    $container.innerHTML = "<h1>ê°œì‹œê¸€ ëª©ë¡</h1>";
  }
}
route();

// aíƒœê·¸ë¥¼ ë°©ì§€í•˜ê³  history ì‚¬ìš©
window.addEventListener("click", (e) => {
  if (e.target.className === "linkItem") {
    e.preventDefault(); // aíƒœê·¸ í˜ì´ì§€ ì´ë™ ë°©ì§€

    const { href } = e.target; // pathë¡œ href ê°€ì ¸ì˜¤ê¸°
    const path = href.replace(window.location.origin, "");

    console.log(path);

    history.pushState(null, null, path); // historyë¡œ ë¦¬ëœë” ì—†ì´ url ë³€ê²½
    route();
  }
});

// ë’¤ë¡œê°€ê¸° ì•ìœ¼ë¡œê°€ê¸° í–ˆì„ë•Œ ë™ì‘í•˜ë„ë¡ rounte()ì‹¤í–‰
window.addEventListener("popstate", () => route());
```
